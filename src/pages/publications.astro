---
import AboutHeroImage from "../assets/blog-placeholder-about.jpg";
import Layout from "../layouts/BaseLayout.astro";
import authorJson from "../data/author.json";

const API_KEY = process.env.SERPAPI_KEY;

interface Article {
	title: string;
	link: string;
	authors: string;
	publication: string;
	cited_by: {
		value: number;
		link: string;
	};
	year: string;
}

interface Author {
	author: {
		name: string;
		affiliations: string;
		interests: {
			title: string;
			link: string;
		}[];
	};
	articles: Article[];
}

const author: Author = await (async () => {
	if (API_KEY) {
		const request = await fetch(
			`https://serpapi.com/search?api_key=${API_KEY}&engine=google_scholar_author&hl=en&author_id=HczSncoAAAAJ`,
		);
		const response = await request.json();
		return response;
	} else {
		return authorJson;
	}
})();

const { articles } = author;
---

<Layout title="Publications">
	<main>
		<section>
			<ul class="publications-list">
				{
					articles.map((article) => (
						<li>
							<h4>{article.title}</h4>
							<div class="info">
								<div class="publication">
									<div>
										<a
											class="cited-by"
											href={article.cited_by.link}
											target="_blank"
										>
											Cited by {article.cited_by.value}{" "}
											papers
											<svg
												xmlns="http://www.w3.org/2000/svg"
												viewBox="0 0 16 16"
												id="Link--Streamline-Font-Awesome"
												height="16"
												width="16"
											>
												<path
													d="M14.74057 8.303560000000001c1.4659075000000001 -1.4659050000000002 1.4659075000000001 -3.8398950000000003 0 -5.3058000000000005 -1.29726 -1.2972625000000002 -3.3417450000000004 -1.4659050000000002 -4.833595 -0.3995575l-0.04151250000000001 0.02854c-0.3736125 0.2672375 -0.45923 0.7861400000000001 -0.19199500000000003 1.1571575s0.7861400000000001 0.45923 1.1571575 0.19199500000000003l0.04151250000000001 -0.02854c0.8328424999999999 -0.594145 1.9718375000000004 -0.5007425 2.693115 0.22313000000000002 0.8172750000000001 0.8172750000000001 0.8172750000000001 2.14048 0 2.957755L10.6541975 10.044485000000002c-0.8172750000000001 0.8172750000000001 -2.1404825 0.8172750000000001 -2.9577575 0 -0.72387 -0.7238725 -0.8172750000000001 -1.8628675000000001 -0.22312750000000003 -2.693115l0.02854 -0.04151250000000001c0.267235 -0.3736125 0.17902 -0.8925175 -0.19199500000000003 -1.1571575s-0.8925175 -0.1790225 -1.1571575 0.19199500000000003l-0.02854 0.04151250000000001c-1.0689425000000001 1.489255 -0.9003000000000001 3.5337400000000003 0.39696250000000005 4.831 1.4659050000000002 1.4659075000000001 3.8398925 1.4659075000000001 5.3058000000000005 0l2.9136475 -2.9136475ZM1.25943 7.69644c-1.4659075000000001 1.4659075000000001 -1.4659075000000001 3.8398950000000003 0 5.3058000000000005 1.29726 1.2972625000000002 3.3417450000000004 1.4659050000000002 4.833595 0.3995575l0.04151250000000001 -0.02854c0.3736125 -0.267235 0.45923 -0.7861400000000001 0.19199500000000003 -1.1571575s-0.7861400000000001 -0.45923 -1.1571575 -0.19199500000000003l-0.04151250000000001 0.02854c-0.8328424999999999 0.594145 -1.9718375000000004 0.5007425 -2.693115 -0.22313000000000002 -0.8172750000000001 -0.8198675 -0.8172750000000001 -2.143075 0 -2.96035l2.911055 -2.9136500000000005c0.8172750000000001 -0.8172750000000001 2.1404825 -0.8172750000000001 2.9577575 0 0.72387 0.7238725 0.8172750000000001 1.8628675000000001 0.22312750000000003 2.69571l-0.02854 0.04151250000000001c-0.267235 0.3736125 -0.17902 0.8925150000000001 0.19199500000000003 1.1571575s0.8925175 0.1790225 1.1571575 -0.19199500000000003l0.02854 -0.04151250000000001c1.068945 -1.4918500000000001 0.9003000000000001 -3.536335 -0.39696250000000005 -4.833595 -1.4659050000000002 -1.4659075000000001 -3.8398925 -1.4659075000000001 -5.3058000000000005 0L1.25943 7.69644Z"
													fill="currentColor"
													stroke-width="0.025"
												/>
											</svg>
										</a>
									</div>
									<div>Published in {article.year}</div>
									<div>{article.publication}</div>
									<div>{article.authors}</div>
									<a
										class="link"
										href={article.link}
										target="_blank"
									>
										View
										<svg
											xmlns="http://www.w3.org/2000/svg"
											viewBox="0 0 16 16"
											id="Link--Streamline-Font-Awesome"
											height="16"
											width="16"
										>
											<path
												d="M14.74057 8.303560000000001c1.4659075000000001 -1.4659050000000002 1.4659075000000001 -3.8398950000000003 0 -5.3058000000000005 -1.29726 -1.2972625000000002 -3.3417450000000004 -1.4659050000000002 -4.833595 -0.3995575l-0.04151250000000001 0.02854c-0.3736125 0.2672375 -0.45923 0.7861400000000001 -0.19199500000000003 1.1571575s0.7861400000000001 0.45923 1.1571575 0.19199500000000003l0.04151250000000001 -0.02854c0.8328424999999999 -0.594145 1.9718375000000004 -0.5007425 2.693115 0.22313000000000002 0.8172750000000001 0.8172750000000001 0.8172750000000001 2.14048 0 2.957755L10.6541975 10.044485000000002c-0.8172750000000001 0.8172750000000001 -2.1404825 0.8172750000000001 -2.9577575 0 -0.72387 -0.7238725 -0.8172750000000001 -1.8628675000000001 -0.22312750000000003 -2.693115l0.02854 -0.04151250000000001c0.267235 -0.3736125 0.17902 -0.8925175 -0.19199500000000003 -1.1571575s-0.8925175 -0.1790225 -1.1571575 0.19199500000000003l-0.02854 0.04151250000000001c-1.0689425000000001 1.489255 -0.9003000000000001 3.5337400000000003 0.39696250000000005 4.831 1.4659050000000002 1.4659075000000001 3.8398925 1.4659075000000001 5.3058000000000005 0l2.9136475 -2.9136475ZM1.25943 7.69644c-1.4659075000000001 1.4659075000000001 -1.4659075000000001 3.8398950000000003 0 5.3058000000000005 1.29726 1.2972625000000002 3.3417450000000004 1.4659050000000002 4.833595 0.3995575l0.04151250000000001 -0.02854c0.3736125 -0.267235 0.45923 -0.7861400000000001 0.19199500000000003 -1.1571575s-0.7861400000000001 -0.45923 -1.1571575 -0.19199500000000003l-0.04151250000000001 0.02854c-0.8328424999999999 0.594145 -1.9718375000000004 0.5007425 -2.693115 -0.22313000000000002 -0.8172750000000001 -0.8198675 -0.8172750000000001 -2.143075 0 -2.96035l2.911055 -2.9136500000000005c0.8172750000000001 -0.8172750000000001 2.1404825 -0.8172750000000001 2.9577575 0 0.72387 0.7238725 0.8172750000000001 1.8628675000000001 0.22312750000000003 2.69571l-0.02854 0.04151250000000001c-0.267235 0.3736125 -0.17902 0.8925150000000001 0.19199500000000003 1.1571575s0.8925175 0.1790225 1.1571575 -0.19199500000000003l0.02854 -0.04151250000000001c1.068945 -1.4918500000000001 0.9003000000000001 -3.536335 -0.39696250000000005 -4.833595 -1.4659050000000002 -1.4659075000000001 -3.8398925 -1.4659075000000001 -5.3058000000000005 0L1.25943 7.69644Z"
												fill="currentColor"
												stroke-width="0.025"
											/>
										</svg>
									</a>
								</div>
							</div>
						</li>
					))
				}
			</ul>
		</section>
	</main>
</Layout>

<style>
	main {
		width: 960px;
	}
	h4 {
		font-size: 1.2rem;
	}
	li {
		margin: 0.5rem;
		display: flex;
		flex-direction: column;
		align-items: stretch;
	}
	.publications-list {
		display: flex;
		flex-direction: column;
		flex-wrap: wrap;
		list-style-type: none;
	}

	.info {
		display: flex;
		font-size: 0.9em;
		color: rgb(var(--gray));
	}
	a {
		color: rgb(var(--text-sub));
		text-decoration: none;
		transition: color 0.2s;
	}
	a:hover {
		color: rgb(var(--text-sub-lighten));
	}
	.link {
		font-size: 0.9em;
	}
</style>
